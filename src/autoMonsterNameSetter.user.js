// ==UserScript==
// @name         AutoMonsterNameSetter
// @namespace    http://tampermonkey.net/
// @version      2023-12-29
// @description  try to take over the world!
// @author       You
// @match        https://gamewith.jp/monsters3/*
// @require      https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js
// @grant        none
// ==/UserScript==

(async function () {
    'use strict';
    const monsters = {
        "スライム": "1",
        "はねスライム": "2",
        "バブルスライム": "3",
        "いばらドラゴン": "4",
        "コドラ": "5",
        "はなまきドラゴ": "6",
        "フェアリードラゴン": "7",
        "おおにわとり": "8",
        "キャタピラー": "9",
        "くしざしツインズ": "10",
        "テールイーター": "11",
        "ナスビナーラ": "12",
        "プチアーノン": "13",
        "アントベア": "14",
        "いたずらもぐら": "15",
        "いっかくうさぎ": "16",
        "ファーラット": "17",
        "シールドこぞう": "18",
        "ドラキー": "19",
        "メーダ": "20",
        "モーモン": "21",
        "リップス": "22",
        "サイクロプス": "23",
        "アニマルゾンビ": "24",
        "おばけキノコ": "25",
        "がいこつ": "26",
        "きりかぶおばけ": "27",
        "ゴースト": "28",
        "マンドラ": "29",
        "どろにんぎょう": "30",
        "ズッキーニャ": "31",
        "ももんじゃ": "32",
        "ホイミスライム": "33",
        "スライムベス": "34",
        "はじけドーラ": "35",
        "ドラゴン": "36",
        "おおがらす": "37",
        "フロッガー": "38",
        "かまいたち": "39",
        "ランタンこぞう": "40",
        "あばれこまいぬ": "41",
        "ドラムゴート": "42",
        "メラゴースト": "43",
        "シャドー": "44",
        "フォレストドラゴ": "45",
        "ドラゴンキッズ": "46",
        "ベビーサタン": "47",
        "グレムリン": "48",
        "プテラノドン": "49",
        "ホイップゴースト": "50",
        "ピクシー": "51",
        "マッシュスライム": "52",
        "スノーム": "53",
        "おばけヒトデ": "54",
        "ジャングラー": "55",
        "ポンポコだぬき": "56",
        "スライムつむり": "57",
        "ベビーパンサー": "58",
        "スマイルリザード": "59",
        "たまねぎスライム": "60",
        "どんぐりベビー": "61",
        "スライムツリー": "62",
        "ボックススライム": "63",
        "スライムタワー": "64",
        "ドロヌーバ": "65",
        "マドハンド": "66",
        "おばけプレート": "67",
        "おばけキャンドル": "68",
        "ドロザラー": "69",
        "ランドセーラー": "70",
        "ミステリドール": "71",
        "シャイニング": "72",
        "アイアンタートル": "73",
        "いっかく竜": "74",
        "メタッピー": "75",
        "パールスライム": "76",
        "わらいぶくろ": "77",
        "トルトリーナ": "78",
        "ギズモ": "79",
        "ゆめにゅうどう": "80",
        "ワイバーンドッグ": "81",
        "イエティ": "82",
        "コサックシープ": "83",
        "おおねずみ": "84",
        "ビッグハット": "85",
        "ホークマン": "86",
        "くらやみハーピー": "87",
        "ぶちスライム": "88",
        "ポイズンリザード": "89",
        "デンデン竜": "90",
        "キャットフライ": "91",
        "ダッシュラン": "92",
        "おにこぞう": "93",
        "びっくりサタン": "94",
        "ドルイド": "95",
        "ドロル": "96",
        "やみしばり": "97",
        "くさった死体": "98",
        "スカルガルー": "99",
        "オーク": "100",
        "ミノーン": "101",
        "からくりエッグ": "102",
        "おおきづち": "103",
        "マーマン": "104",
        "オニオーン": "105",
        "シーホース": "106",
        "タップペンギー": "107",
        "ふゆうじゅ": "108",
        "キラーコーン": "109",
        "あばれうしどり": "110",
        "スカルライダー": "111",
        "ウィングスネーク": "112",
        "ピッキー": "113",
        "ドラゴスライム": "114",
        "はさみくわがた": "115",
        "ぬすっとウサギ": "116",
        "シーメーダ": "117",
        "わかめ王子": "118",
        "みみとびねずみ": "119",
        "フォンデュ": "120",
        "オクトリーチ": "121",
        "くみひもこぞう": "122",
        "ひとくいばこ": "123",
        "おおめだま": "124",
        "ガルーダ": "125",
        "たけやりへい": "126",
        "ベビーマジシャン": "127",
        "ごろつき": "128",
        "ひとくいサーベル": "129",
        "スライムカルゴ": "130",
        "くものきょじん": "131",
        "コンジャラー": "132",
        "クロコマーチ": "133",
        "スライムナイト": "134",
        "さまようよろい": "135",
        "メタルハンター": "136",
        "ひぐれバット": "137",
        "とげジョボー": "138",
        "スキッパー": "139",
        "サボテンボール": "140",
        "スライムコロネ": "141",
        "しましまキャット": "142",
        "チョコゴーレム": "143",
        "メイデンドール": "144",
        "ひくいどり": "145",
        "ほうおう": "146",
        "にじくじゃく": "147",
        "リザードマン": "148",
        "ネクロバルサ": "149",
        "まおうのつかい": "150",
        "アンクルホーン": "151",
        "がいこつけんし": "152",
        "ホエールマージ": "153",
        "ぼうれい剣士": "154",
        "フレイム": "155",
        "こんぺいとう": "156",
        "ケセランパセラン": "157",
        "スモールグール": "158",
        "キラーマシン": "159",
        "竜王": "160",
        "ふうらいスライム": "162",
        "キングスライム": "163",
        "ゴーレム": "164",
        "心眼たぬき": "165",
        "おどるほうせき": "166",
        "ばくだんいわ": "167",
        "ドラキーマ": "168",
        "しにがみ": "169",
        "マネマネ": "170",
        "アークマージ": "171",
        "アークデーモン": "172",
        "リリパット": "173",
        "デッドペッカー": "174",
        "シャドウベビー": "175",
        "キラービー": "176",
        "エビルハムスター": "177",
        "スライムベホマズン": "178",
        "てっきゅうまじん": "179",
        "オークキング": "180",
        "じんめんじゅ": "181",
        "フェイスボール": "182",
        "ダークペルシャ": "183",
        "メイジドラキー": "184",
        "ガチャコッコ": "185",
        "スターキメラ": "186",
        "ほのおのせんし": "187",
        "レッドイーター": "188",
        "チョコタワー": "189",
        "ムーンフェイス": "190",
        "ベロベロ": "191",
        "モヒカント": "192",
        "キラージャック": "193",
        "アックスドラゴン": "194",
        "メランザーナ": "195",
        "メタルドラゴン": "196",
        "いどまじん": "197",
        "キラーパンサー": "198",
        "ウイングタイガー": "199",
        "ブルーイーター": "200",
        "メカバーン": "201",
        "りゅうおう": "202",
        "マタンゴ": "203",
        "ヘルビースト": "204",
        "アルゴングレート": "205",
        "ボストロール": "206",
        "ストーンマン": "207",
        "ヘルシーサー": "208",
        "ワイトキング": "209",
        "ぐんたいガニ": "210",
        "魔軍司令ホメロス": "211",
        "リーズレット": "212",
        "ビッグももんじゃ": "213",
        "デスペクテル": "214",
        "じごくのもんばん": "215",
        "ヘルバオム": "216",
        "ベレス": "217",
        "デスソーサー": "218",
        "きめんどうし": "219",
        "デンタザウルス": "220",
        "タコメット": "221",
        "ストーンスライム": "222",
        "ダークキング": "223",
        "ハデスナイト": "224",
        "ゴールデンスライム": "225",
        "あくましんかん": "226",
        "ピサロナイト": "227",
        "うごくせきぞう": "228",
        "フロストギズモ": "229",
        "スライムダーク": "230",
        "ソードドラゴン": "231",
        "イルカちょうちん": "232",
        "ヒートギズモ": "233",
        "きつねび": "234",
        "スピンスライム": "235",
        "プリズニャン": "236",
        "エンタシスマン": "237",
        "ブチュチュンパ": "238",
        "とらおとこ": "239",
        "シールドオーガ": "240",
        "グリズリー": "241",
        "かくとうパンサー": "242",
        "ギガントヒルズ": "243",
        "フーセンドラゴン": "244",
        "デザートデーモン": "245",
        "よろいのきし": "246",
        "しのどれい": "247",
        "モコモコじゅう": "248",
        "スライムタール": "249",
        "トンブレロ": "250",
        "ダークスライム": "251",
        "ミイラおとこ": "252",
        "サタンフーラー": "253",
        "もみじこぞう": "254",
        "ねこまどう": "255",
        "スイーツまじん": "256",
        "メタルキング": "257",
        "やまたのおろち": "258",
        "カイザードラゴン": "259",
        "ベンガル": "260",
        "ライノソルジャー": "261",
        "アームライオン": "262",
        "アンドレアル": "264",
        "デビルアーマー": "265",
        "ピサロのてさき": "266",
        "デュラハンナイト": "268",
        "だんごスライム": "269",
        "しにがみのきし": "270",
        "ボーンナイト": "271",
        "キラーマシン2": "272",
        "ギガンテス": "273",
        "ミミック": "274",
        "キメラ": "275",
        "ブリザード": "276",
        "アルミラージ": "277",
        "スライムジェネラル": "278",
        "サンダーフロッグ": "279",
        "グレイトドラゴン": "280",
        "ヘルコンドル": "281",
        "キラーピッケル": "282",
        "エビルプリースト": "283",
        "エンゼルスライム": "284",
        "オーガー": "285",
        "ガメゴン": "286",
        "しりょうのきし": "288",
        "スペクテット": "289",
        "ダックスビル": "290",
        "チョコホイップ": "291",
        "どくやずきん": "293",
        "毒つぼドラゴン": "294",
        "ぬかどこスライム": "295",
        "ビックアイ": "296",
        "ビーンファイター": "297",
        "ひとつめピエロ": "298",
        "もりもりスライム": "300",
        "ルバンカ": "301",
        "はぐれメタル": "302",
        "わたぼう": "303",
        "シャンタク": "304",
        "バブルキング": "305",
        "グレイナル": "306",
        "ロックちょう": "307",
        "ワニバーン": "308",
        "スライムボーグ": "309",
        "ギュメイ将軍": "310",
        "ジラフマスター": "311",
        "バトルレックス": "312",
        "メガザルロック": "313",
        "ひとくいそう": "314",
        "スライムプディング": "315",
        "れんごく天馬": "316",
        "キングヒドラ": "317",
        "ローズバトラー": "318",
        "ダンジョンえび": "319",
        "ミニデーモン": "320",
        "サブナック": "321",
        "キングリザード": "322",
        "ハニーイーター": "323",
        "スカルゴン": "324",
        "邪神ニズゼルファ": "325",
        "じげんりゅう": "326",
        "ケミカルゼリー": "327",
        "タタリ御前": "328",
        "ブラウニー": "329",
        "キラーアンブレラ": "330",
        "ふくぶくろ": "331",
        "アトラス": "332",
        "アバランチャー": "333",
        "ギガデーモン": "334",
        "アンズー": "335",
        "アラウネ": "336",
        "ウドラー": "337",
        "ウルフドラゴン": "338",
        "王のはかもり": "339",
        "かえんムカデ": "340",
        "メタルスライム": "341",
        "ガメゴンロード": "342",
        "カンダタ": "343",
        "スカイドラゴン": "344",
        "コアトル": "345",
        "コロネホワイト": "346",
        "さそりアーマー": "347",
        "サンダーシャウト": "348",
        "じごくのハサミ": "349",
        "フルーリーサタン": "350",
        "スウィートバッグ": "351",
        "ずしおうまる": "352",
        "ヘルボックル": "353",
        "バーガースライム": "354",
        "スライムジョーカー": "355",
        "スライムフェアリー": "356",
        "クリオネオン": "357",
        "ユニコーン": "358",
        "ようがんまじん": "359",
        "よるのていおう": "360",
        "ライバーン": "361",
        "ランプのまじん": "362",
        "ポイズンゾンビ": "363",
        "ほねリーダー": "364",
        "ポムポムボム": "365",
        "メトロゴースト": "366",
        "もりもりベス": "367",
        "ひょうがまじん": "368",
        "ブラッドハンド": "369",
        "ベホマスライム": "370",
        "ヘルダイバー": "371",
        "ドラゴンポップ": "372",
        "ドラゴンライダー": "373",
        "トロピカキング": "374",
        "ナイトウォーカー": "375",
        "なげきの亡霊": "376",
        "バーガーミミック": "377",
        "せつげんりゅう": "378",
        "ソルジャーブル": "379",
        "つららスライム": "380",
        "デザートゴースト": "381",
        "デビルスノー": "382",
        "トドマン": "383",
        "しびれだんびら": "384",
        "シャドーサタン": "385",
        "シルバーデビル": "386",
        "スノーグリフォン": "387",
        "スノードラゴン": "388",
        "スライムファング": "389",
        "スライムブレス": "390",
        "石炭つむり": "391",
        "ガマキャノン": "392",
        "サイレス": "393",
        "シーゴーレム": "394",
        "じごくのたまねぎ": "395",
        "あらくれチャッピー": "396",
        "岩とびあくま": "397",
        "うずしおキング": "398",
        "エビルアングラー": "399",
        "エビルスピリッツ": "400",
        "ガーゴイル": "401",
        "ソイソルジャー": "402",
        "とつげきうお": "403",
        "グランスライム": "404",
        "キラーマジンガ": "405",
        "オルゴデミーラ": "406",
        "邪神の子": "407",
        "シドー": "408",
        "ゲマ": "409",
        "ドラゴンアビス": "410",
        "デスタムーア": "411",
        "堕天使エルギオス": "412",
        "大魔王ウルノーガ": "413",
        "守護者ラズバーン": "414",
        "ぴぴぼう": "415",
        "バラモスゾンビ": "416",
        "闇竜バルボロス": "417",
        "ロイヤルブルーム": "418",
        "ワルぼう": "419",
        "ミルドラース": "420",
        "ムドー": "421",
        "冥獣王ネルゲル": "422",
        "ももいろキング": "423",
        "ドルマゲス": "424",
        "ハーゴン": "425",
        "アカイライ": "426",
        "おにこんぼう": "427",
        "からくりだいみょう": "428",
        "ギガントドラゴン": "429",
        "ギャスモン": "430",
        "キラーシャドー": "431",
        "キングジョーカー": "432",
        "クイーンスライム": "433",
        "クリスタルスライム": "434",
        "グレイトボンバー": "435",
        "ゲリュオン": "436",
        "荒野シュリンプ": "437",
        "ゴールデンゴーレム": "438",
        "サタンメイル": "439",
        "ジェリーマン": "440",
        "しにがみきぞく": "441",
        "シャドウパンサー": "442",
        "シュプリンガー": "443",
        "スノーホムンクルス": "444",
        "セルゲイナス": "445",
        "ソードイド": "446",
        "ダースリカント": "447",
        "タールキング": "448",
        "デスホール": "449",
        "デュランダル": "450",
        "とうだいタイガー": "451",
        "ドラゴンコープス": "452",
        "トロルボンバー": "453",
        "ドンモグーラ": "454",
        "ニードルフィン": "455",
        "バッファロン": "456",
        "フールフール": "457",
        "ブラックドラゴン": "458",
        "ブラッドオックス": "459",
        "ブルベリーノ": "460",
        "ベロリンマン": "461",
        "ホークブリザード": "462",
        "ホラービースト": "463",
        "メルトア": "464",
        "ライオネック": "465",
        "ランドアーマー": "466",
        "ソードファントム": "467",
        "だいおうイカ": "468",
        "だいおうガマ": "469",
        "タイムマスター": "470",
        "ダンスニードル": "471",
        "ダンビラムーチョ": "472",
        "デスマエストロ": "473",
        "デュラハーン": "474",
        "キャットリベリオ": "475",
        "クームヤーガ": "476",
        "クラーゴン": "477",
        "ゲルニック将軍": "478",
        "黒竜丸": "479",
        "ゴッドライダー": "480",
        "ゴレオン将軍": "481",
        "サラマンダー": "482",
        "シルバーナーガ": "483",
        "Sキラーマシン": "484",
        "スカイシーカー": "485",
        "スライムエンペラー": "486",
        "ダースドラゴン": "487",
        "デスゴーゴン": "488",
        "てんのもんばん": "489",
        "ナイトキング": "490",
        "ネンガル": "491",
        "バズズ": "492",
        "バラモス": "493",
        "バルザック": "494",
        "パンドラボックス": "495",
        "ひかりの番人": "496",
        "ベリアル": "497",
        "ヘルクラッシャー": "498",
        "ホエールロード": "499",
        "まおうのかげ": "500",
        "魔犬レオパルド": "501",
        "マスタースライム": "502",
        "メタルスコーピオン": "503",
        "暗黒神ラプソーン": "504",
        "どくろクラゲ": "505",
        "メタルライダー": "506",
        "デザートランナー": "507",
        "ドルマージュ": "508",
        "黄泉のほのお": "509",
        "ナイトリッチ": "510",
        "なげきムーン": "511",
        "レッドシャモ": "512",
        "ブラックベジター": "513",
        "バザックス": "514",
        "ブラバニクイーン": "515",
        "バルンバ": "516",
        "ブリザードマン": "517",
        "ボーンプリズナー": "518",
        "ぶちスライムベス": "519",
        "ボボンガー": "520",
        "マムー": "521",
        "ホワイトビート": "522",
        "まかいじゅう": "523",
        "しんりゅう": "524",
        "竜神王": "525",
        "ラーミア": "526",
        "神さま": "527",
        "ゾーマ": "528",
        "エスターク": "529",
        "デスピサロ": "530",
        "ヘルバトラー": "531",
        "キングレオ": "532",
        "ダークドレアム": "533"
    }
    const resistanceUrl = 'https://gamewith.jp/monsters3/429624';

    function storeMonsterName() {
        const monsterName = document.getElementById('1')?.textContent.replace('の特性・弱点・耐性', '');
        const monsterId = monsters[monsterName];

        if (monsterName && monsterId) {
            Cookies.set('monsterName', monsterId, { expires: 1 });
        }
    }
    function setMonsterName() {
        if (location.href === resistanceUrl) {
            const monsterNameSelect = document.querySelector('[data-select2-id]');
            if (monsterNameSelect == null) return;

            const monsterId = Cookies.get('monsterName');
            monsterNameSelect.value = monsterId;

            monsterNameSelect.dispatchEvent(new Event('change'));
            $('[data-select2-id]').first().trigger({
                type: 'select2:select',
                params: {
                    data: {
                        id: monsterId
                    }
                }
            });
        }
    }

    /**
    * aタグのテキスト、リンクを転記
    * @param {HTMLAnchorElement} source 転記元
    * @param {HTMLAnchorElement} destination 転記先
    */
    function replaceMenuContent(source, destination) {
        if (!source || !destination) return;
        destination.textContent = source.textContent;
        destination.href = source.href;
    }

    /**
     * 序盤おすすめ配合メニューを耐性計算ツールメニューに変更
     */
    function replaceBreedingWithResistanceCalc() {
        const source = document.querySelectorAll('.tips-vertical-menu_item.gtm-ga4-walkthrough-click-event')[3];
        const destination = document.querySelectorAll('.global-menu-wrap.cf .global-menu.cf .global-menu_item a')[4];
        replaceMenuContent(source, destination);
    }


    function main() {
        storeMonsterName();
        setMonsterName();
        replaceBreedingWithResistanceCalc();
    }

    setTimeout(main, 500);
})();